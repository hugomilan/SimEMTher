function [] = tlmsimular()
global ent dl k tabcar camposimu dtTLM simu dimenmalha saltosimu TEM ...
    carregar calesp Tempin

TE = 0;
TM = 0;
if TEM == 1;
    TM = 1;
elseif TEM == 2
    TE = 1;
end

%% VERIFICAR CAMPO ELÉTRICO NA FONTE E NA FUNÇÃO DE ESPALHAMENTO

%% Inserir diaanimal em prepro e advec

% implementar unidimensional EM

% Colocar análise de Fourier (nova gui)

% possibilitar na visualização dos resultados encontrar W/m², W/m e W

% ajustar o tamanho da figura da fonte, pode ser inserido um valor maior que
% a malha de simulação.


%% Ar, coração, sangue, veia. Peso específico retirados de Saito em ablação
% e = [1 54.814 58.264 42.531 54.814]; %adimensional 2.4GHz
% sigma = [0 2.2561 2.5448 1.4353 2.2561]; %S/m

%coração: 54.8140; 2.2561; 1; 1047; 3500; 0.6; 310;
%cobre: 1; 5e8; 1; 8920; 390; 398;
%Ar: 1; 0; 1; 1.2; 1000; 0.023;

%tio alex
%meio 1: 1000, 3600, 0.5, 311, 0.5e-3, 200, 0, 0;
%meio 2: 1.5, 10000, 0.27, 311, 0, 0, 23, 0.98;
%meio 3: 1.2, 1000, 0.023, 301, 0, 0, 40, 1;

tic;
cri = clock;
cl = 10; %Número de amostragem do tempo. Número Natural > 0;
% Características dos valores da malha
e = tabcar(:,1)';           % adimensional
sigma = tabcar(:,2)';       % S/m
u = tabcar(:,3)';           % adimensional
ro = tabcar(:,4)';          % kg/m³
calesp = tabcar(:,5)';      % J/(kg*K)
Kter = tabcar(:,6)';        % W/(m*K)
Tempin = tabcar(:,7)';      % K
wsan = tabcar(:,8)';        % W/m3
qmsan = tabcar(:,9)';       % W/m3
emis = tabcar(:,10)';       % adimensional
fig = 1:size(tabcar,1);
% Diakopticas
nsdx = 3; %Subdomínios em x
nsdy = 3; %Subdomínios em y

% Memoria
[amemoria bmemoria]= memory;
ngb = bmemoria.PhysicalMemory.Available/(1e9*10);

%% Testes

%teste de convergência
% e0 = 8.854e-12;
% u0 = 4*pi*1e-7;
% c = sqrt(1/(e0*u0));
% teste = dl*f/c;
% lambda = c/f;

teste = 0.01;

if teste <= 0.1
    %% Fórmulas e Pré-processamento
    % O algoritmo trabalha com (y,x)
    
    [nnosy, nnosx, S, Ty, Tx, SARval, fonemter, foninter, Ster, ...
        Zter, Rter, Gter, Zterx, Ztery, Z2c, Rterx, Rtery, Zfatx, Zfaty, ...
        IF, fatex, fatey, fathzx, fathzy, Zc, ZLTx, ZLTy, Gx, Gy, Zs, Rs, ...
        Tempinmatriz, reflintn, rfemag, YLTx, YLTy, Yc, Ys, ...
        Gs, Ysf, YLTxf, YLTyf, MFSB, MFNO, MFCON, ZG2n] = ...
        prepro(ent, dl, e, u, sigma, ro, fig, ...
        nsdy, nsdx, camposimu, calesp, Kter, wsan, qmsan, emis, Tempin, dtTLM, simu, TE, TM);
    
    %% Modelagem da Fonte
    
    [funcao, tfuncao, Pin3m, Pindk, nosfon] = fonte(dtTLM, ent, k, nnosy, nnosx, Tx, Ty, ...
        nsdy, nsdx, dl, fatex, fatey, fathzx, fathzy, Zc, Zter, Gter, YLTx, YLTy, Yc, simu, TE, TM);
    
    %% Varrendo os subdomínios
    
    [malha, Tbs, Tbdk, Tbster, Tbterdk, resul, nres, reflint, rfemagdk, entdk, FSBF,...
        FNOF, FCOF] = ...
        subdominio(nsdy, nsdx, Ty, Tx, k, Tempinmatriz, camposimu, fig,...
        ent, nnosy, nnosx, ngb, reflintn, rfemag, simu, Gter, Zter, Rter,...
        Zterx, Ztery, Rterx, Rtery, Z2c, Kter, IF, dl, emis);
    
   
    %% Advecção
    [ADSB, ADNO, ADCON] = advec(Zterx, Ztery, Zter, Z2c,...
        Gter, Tempin, emis, Kter, nnosx, nnosy);
    
    disp (' ')
    disp (['Simulando ', num2str(k),' passos-de-tempo.'])
    disp(['Salvando os pontos a cada ', num2str(saltosimu),' passos-de-tempo'])
    
    if dimenmalha == 1
        
        disp(['Simulando um espaço de ',num2str(Tx*dl),' m'])
        disp(['Com ',num2str(k*dtTLM),' segundos'])
        disp ''
    elseif dimenmalha == 2
        disp(['Simulando um espaço de ',num2str(Tx*dl),'x',num2str(Ty*dl),' m'])
        disp(['Com ',num2str(k*dtTLM),' segundos'])
        disp ''
    end
    
    
    if carregar == 1
        aref = size(malha{1,1}{1,1},2);
        carre = load('malhasav');
        bref = size(carre.malha{1,1}{1,1},2);
        if aref == 9 && bref == 4
            for ac1 = 1:size(malha,1)
                for ac2 = 1:size(malha,2)
                    for bc1 = 1:size(malha{ac1,ac2},1)
                        for bc2 = 1:size(malha{ac1,ac2},2)
                            malha{ac1,ac2}{bc1,bc2}(:,6:9) = carre.malha{ac1,ac2}{bc1,bc2}(:,1:4);
                        end
                    end
                end
            end
        elseif aref == 9 && bref == 5
            for ac1 = 1:size(malha,1)
                for ac2 = 1:size(malha,2)
                    for bc1 = 1:size(malha{ac1,ac2},1)
                        for bc2 = 1:size(malha{ac1,ac2},2)
                            malha{ac1,ac2}{bc1,bc2}(:,1:5) = carre.malha{ac1,ac2}{bc1,bc2}(:,1:5);
                        end
                    end
                end
            end
        elseif aref == 5 && bref == 9
            for ac1 = 1:size(malha,1)
                for ac2 = 1:size(malha,2)
                    for bc1 = 1:size(malha{ac1,ac2},1)
                        for bc2 = 1:size(malha{ac1,ac2},2)
                            malha{ac1,ac2}{bc1,bc2}(:,1:5) = carre.malha{ac1,ac2}{bc1,bc2}(:,1:5);
                        end
                    end
                end
            end
        elseif aref == 4 && bref == 9
            for ac1 = 1:size(malha,1)
                for ac2 = 1:size(malha,2)
                    for bc1 = 1:size(malha{ac1,ac2},1)
                        for bc2 = 1:size(malha{ac1,ac2},2)
                            malha{ac1,ac2}{bc1,bc2}(:,1:4) = carre.malha{ac1,ac2}{bc1,bc2}(:,6:9);
                        end
                    end
                end
            end
        else
            for ac1 = 1:size(malha,1)
                for ac2 = 1:size(malha,2)
                    for bc1 = 1:size(malha{ac1,ac2},1)
                        for bc2 = 1:size(malha{ac1,ac2},2)
                            malha{ac1,ac2}{bc1,bc2}(:,:) = carre.malha{ac1,ac2}{bc1,bc2}(:,:);
                        end
                    end
                end
            end
            %Ajustando as fronteiras com conduçao
            if Tbterdk(1,6) ~=0
                  Tbterdk(1,2) = carre.Tbterdk(1,2)*Tbterdk(1,3)/carre.Tbterdk(1,3);
            end
            if Tbterdk(2,6) ~=0
                Tbterdk(2,2) = carre.Tbterdk(2,2)*Tbterdk(2,3)/carre.Tbterdk(2,3);
            end
        end
    end
    
    toc1 = toc;
    msg1 = seg2dhms(toc1); %Mostra tempo de pré-dados
    disp (['Tempo de pré-dados: ', msg1,'.'])
    if dimenmalha == 1
        if nsdx >= 3
            
            if camposimu == 13 %Somente Térmico
                if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                    nuniter (k, nres, cl, resul, malha, Tbster, nsdx, ...
                        tfuncao, funcao, nosfon, Ster, Tbterdk, Pin3m, Pindk, entdk, foninter, ...
                        nnosx, toc1, Tx, reflint, MFSB, MFNO, MFCON, ZG2n, FSBF, FNOF, FCOF, ...
                        ADSB, ADNO, ADCON)
                    
                elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                    nuniterinfr (k, nres, cl, resul, malha, Tbster, nsdx, ...
                        tfuncao, funcao, nosfon, Ster, Tbterdk, Pin3m, Pindk, entdk, foninter, ...
                        nnosx, toc1, Tx, reflint, MFSB, MFNO, MFCON, ZG2n, FSBF, FNOF, FCOF)
                    
                elseif MFSB(1,1) ~= 0 && ADSB(1,1) ~= 0
                    nuniterinad (k, nres, cl, resul, malha, Tbster, nsdx, ...
                        tfuncao, funcao, nosfon, Ster, Tbterdk, Pin3m, Pindk, entdk, foninter, ...
                        nnosx, toc1, Tx, reflint, MFSB, MFNO, MFCON, ZG2n, ADSB, ADNO, ADCON)
                    
                elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                    nuniteradfr (k, nres, cl, resul, malha, Tbster, nsdx, ...
                        tfuncao, funcao, nosfon, Ster, Tbterdk, Pin3m, Pindk, entdk, foninter, ...
                        nnosx, toc1, Tx, reflint, ZG2n, FSBF, FNOF, FCOF, ...
                        ADSB, ADNO, ADCON)
                    
                elseif MFSB(1,1) ~= 0
                    nuniterf (k, nres, cl, resul, malha, Tbster, nsdx, ...
                        tfuncao, funcao, nosfon, Ster, Tbterdk, Pin3m, Pindk, entdk, foninter, ...
                        nnosx, toc1, Tx, reflint, MFSB, MFNO, MFCON, ZG2n)
                    
                elseif FSBF(1,1) ~= 0
                    nuniterfro (k, nres, cl, resul, malha, Tbster, nsdx, ...
                        tfuncao, funcao, nosfon, Ster, Tbterdk, Pin3m, Pindk, entdk, foninter, ...
                        nnosx, toc1, Tx, reflint, ZG2n, FSBF, FNOF, FCOF)
                    
                elseif ADSB(1,1) ~= 0
                    nuniterad (k, nres, cl, resul, malha, Tbster, nsdx, ...
                        tfuncao, funcao, nosfon, Ster, Tbterdk, Pin3m, Pindk, entdk, foninter, ...
                        nnosx, toc1, Tx, reflint, ZG2n, ADSB, ADNO, ADCON)
                    
                else
                    nuniterff (k, nres, cl, resul, malha, Tbster, nsdx, ...
                        tfuncao, funcao, nosfon, Ster, Tbterdk, Pin3m, Pindk, entdk, foninter, ...
                        nnosx, toc1, Tx, reflint, ZG2n)
                    
                    
                end
            end
        else
            disp 'suportado somente para malhas 3 ou maior'
        end
    elseif dimenmalha == 2
        %% função recursiva
        if nsdy >= 3 && nsdx >= 3
            %% Caso malha 3x3 ou maior
            
            if TM == 1
                if camposimu == 2 %Hx
                    nresnhx (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, YLTxf, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    
                elseif camposimu == 6   %Hx e Hy
                    nresnhxhy (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    
                elseif camposimu == 14  %Hx e Ez
                    nresnhxez (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    
                elseif camposimu == 22  %Hx e SAR
                    nresnhxsar (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    
                elseif camposimu == 26 %Hx e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnhxter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif MFSB(1,1) ~= 0
                        nresnhxterf (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        
                    elseif FSBF(1,1) ~= 0
                        nresnhxterfro (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif ADSB(1,1) ~= 0
                        nresnhxterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    else
                        nresnhxterff (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        
                    end
                    
                elseif camposimu == 42  %Hx, Hy e Ez
                    nresnhxhyez (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    
                elseif camposimu == 66  %Hx, Hy e SAR
                    nresnhxhysar (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    
                elseif camposimu == 78 %Hx, Hy e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxhyterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxhyterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxhyterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnhxhyter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif MFSB(1,1) ~= 0
                        nresnhxhyterf (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        
                    elseif FSBF(1,1) ~= 0
                        nresnhxhyterfro (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif ADSB(1,1) ~= 0
                        nresnhxhyterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    else
                        nresnhxhyterff (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        
                    end
                    
                elseif camposimu == 154 %Hx, Ez e SAR
                    nresnhxezsar (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    
                elseif camposimu == 182 %Hx, Ez e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxezterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxezterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxezterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnhxezter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif MFSB(1,1) ~= 0
                        nresnhxezterf (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        
                    elseif FSBF(1,1) ~= 0
                        nresnhxezterfro (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif ADSB(1,1) ~= 0
                        nresnhxezterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    else
                        nresnhxezterff (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        
                    end
                    
                elseif camposimu == 286 %Hx, SAR e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxsarterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxsarterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxsarterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnhxsarter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif MFSB(1,1) ~= 0
                        nresnhxsarterf (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        
                    elseif FSBF(1,1) ~= 0
                        nresnhxsarterfro (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif ADSB(1,1) ~= 0
                        nresnhxsarterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    else
                        nresnhxsarterff (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        
                    end
                    
                elseif camposimu == 462 %Hx, Hy, Ez e SAR
                    nresnhxhyezsar (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    
                elseif camposimu == 546 %Hx, Hy, Ez e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxhyezterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxhyezterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxhyezterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnhxhyezter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif MFSB(1,1) ~= 0
                        nresnhxhyezterf (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        
                    elseif FSBF(1,1) ~= 0
                        nresnhxhyezterfro (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif ADSB(1,1) ~= 0
                        nresnhxhyezterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    else
                        nresnhxhyezterff (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        
                    end
                    
                elseif camposimu == 858 %Hx, Hy, SAR e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxhysarterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxhysarterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxhysarterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnhxhysarter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif MFSB(1,1) ~= 0
                        nresnhxhysarterf (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        
                    elseif FSBF(1,1) ~= 0
                        nresnhxhysarterfro (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif ADSB(1,1) ~= 0
                        nresnhxhysarterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    else
                        nresnhxhysarterff (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        
                    end
                    
                elseif camposimu == 2002 %Hx, Ez, SAR e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxezsarterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxezsarterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxezsarterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnhxezsarter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif MFSB(1,1) ~= 0
                        nresnhxezsarterf (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        
                    elseif FSBF(1,1) ~= 0
                        nresnhxezsarterfro (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif ADSB(1,1) ~= 0
                        nresnhxezsarterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    else
                        nresnhxezsarterff (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        
                    end
                    
                elseif camposimu ==6006 %Hx, Hy, Ez, SAR e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxhyezsarterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxhyezsarterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhxhyezsarterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnhxhyezsarter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif MFSB(1,1) ~= 0
                        nresnhxhyezsarterf (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        
                    elseif FSBF(1,1) ~= 0
                        nresnhxhyezsarterfro (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif ADSB(1,1) ~= 0
                        nresnhxhyezsarterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    else
                        nresnhxhyezsarterff (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        
                        
                    end
                    
                elseif camposimu == 3   %Hy
                    nresnhy (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, YLTyf, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    
                elseif camposimu == 21  %Hy e Ez
                    nresnhyez (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    
                elseif camposimu == 33  %Hy e SAR
                    nresnhysar (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    
                elseif camposimu == 39 %Hy e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhyterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhyterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhyterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnhyter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif MFSB(1,1) ~= 0
                        nresnhyterf (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        
                    elseif FSBF(1,1) ~= 0
                        nresnhyterfro (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif ADSB(1,1) ~= 0
                        nresnhyterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    else
                        nresnhyterff (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        
                    end
                    
                elseif camposimu == 231 %Hy, Ez e SAR
                    nresnhyezsar (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    
                elseif camposimu == 273 %Hy, Ez e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhyezterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhyezterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhyezterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF, ...
                            ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnhyezter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif MFSB(1,1) ~= 0
                        nresnhyezterf (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        
                    elseif FSBF(1,1) ~= 0
                        nresnhyezterfro (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif ADSB(1,1) ~= 0
                        nresnhyezterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    else
                        nresnhyezterff (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        
                    end
                    
                elseif camposimu == 429 %Hy, SAR e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhysarterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhysarterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhysarterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnhysarter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif MFSB(1,1) ~= 0
                        nresnhysarterf (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        
                    elseif FSBF(1,1) ~= 0
                        nresnhysarterfro (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif ADSB(1,1) ~= 0
                        nresnhysarterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    else
                        nresnhysarterff (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        
                    end
                    
                    
                elseif camposimu ==3003 %Hy, Ez, SAR e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhyezsarterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter,...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhyezsarterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter,...
                            ADSB, ADNO, ADCON)
                        
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhyezsarterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter,...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnhyezsarter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif MFSB(1,1) ~= 0
                        nresnhyezsarterf (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        
                    elseif FSBF(1,1) ~= 0
                        nresnhyezsarterfro (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif ADSB(1,1) ~= 0
                        nresnhyezsarterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter,...
                            ADSB, ADNO, ADCON)
                        
                    else
                        nresnhyezsarterff (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        
                    end
                    
                elseif camposimu == 7   %Ez
                    nresnez (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    
                elseif camposimu == 77  %Ez e SAR
                    nresnezsar (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    
                elseif camposimu == 91  %Ez e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnezterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnezterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnezterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnezter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif ADSB(1,1) ~= 0
                        nresnezterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0
                        nresnezterf (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        
                    elseif FSBF(1,1) ~= 0
                        nresnezterfro (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    else
                        nresnezterff (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        
                    end
                    
                elseif camposimu == 1001 %Ez, SAR e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnezsarterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnezsarterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnezsarterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnezsarter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif MFSB(1,1) ~= 0
                        nresnezsarterf (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        
                    elseif FSBF(1,1) ~= 0
                        nresnezsarterfro (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif ADSB(1,1) ~= 0
                        nresnezsarterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    else
                        nresnezsarterff (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        
                    end
                    
                elseif camposimu == 11  %SAR
                    nresnsar (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    
                elseif camposimu == 143 %SAR e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnsarterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnsarterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnsarterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnsarter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif MFSB(1,1) ~= 0
                        nresnsarterf (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        
                    elseif FSBF(1,1) ~= 0
                        nresnsarterfro (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif ADSB(1,1) ~= 0
                        nresnsarterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    else
                        nresnsarterff (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, SARval, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        
                    end
                    
                elseif camposimu == 13 && simu == 1 %Eletromagnético-Térmico
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnemterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnemter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif MFSB(1,1) && ADSB(1,1) ~= 0
                        nresnemterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnemterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0
                        nresnemterf (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        
                    elseif FSBF(1,1) ~= 0
                        nresnemterfro (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, FSBF, FNOF, FCOF)
                        
                    elseif ADSB(1,1) ~= 0
                        nresnemterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        
                    else
                        nresnemterff (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, YLTxf, YLTyf, Ysf, Yc, Ster, ...
                            reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        
                    end
                end
                
                
                
                
                
                
                
                
                
                %% Modo TE
            elseif TE == 1
                
                if camposimu == 2   %Ex
                    nresnex( k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, fatex, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    %feito
                elseif camposimu == 6 %Ex e Ey
                    nresnexey (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    %feito
                elseif camposimu == 14 %Ex e Hz
                    nresnexhz (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    %feito
                elseif camposimu == 22 %Ex e SAR
                    nresnexsar (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    %feito
                elseif camposimu == 26 %Ex e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnexterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnexterinfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif MFSB(1,1) && ADSB(1,1) ~= 0
                        nresnexterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        %feito
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnexterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0
                        nresnexterin (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    elseif FSBF(1,1) ~= 0
                        nresnexterfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif ADSB(1,1) ~= 0
                        nresnexterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    else
                        nresnexter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    end
                elseif camposimu == 42  %Ex, Ey e Hz
                    nresnexeyhz (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    %feito
                elseif camposimu == 66  %Ex, Ey e SAR
                    nresnexeysar (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    %feito
                elseif camposimu == 78 %Ex, Ey e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnexeyterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnexeyterinfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif MFSB(1,1) && ADSB(1,1) ~= 0
                        nresnexeyterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        %feito
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnexeyterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0
                        nresnexeyterin (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    elseif FSBF(1,1) ~= 0
                        nresnexeyterfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif ADSB(1,1) ~= 0
                        nresnexeyterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    else
                        nresnexeyter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    end
                    
                    
                elseif camposimu == 154 %Ex, Hz e SAR
                    nresnexhzsar (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    %feito
                elseif camposimu == 182 %Ex, Hz e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnexhzterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnexhzterinfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif MFSB(1,1) && ADSB(1,1) ~= 0
                        nresnexhzterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        %feito
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnexhzterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0
                        nresnexhzterin (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    elseif FSBF(1,1) ~= 0
                        nresnexhzterfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif ADSB(1,1) ~= 0
                        nresnexhzterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    else
                        nresnexhzter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    end
                elseif camposimu == 286 %Ex, SAR e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnexsarterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnexsarterinfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif MFSB(1,1) && ADSB(1,1) ~= 0
                        nresnexsarterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        %feito
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnexsarterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0
                        nresnexsarterin (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    elseif FSBF(1,1) ~= 0
                        nresnexsarterfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif ADSB(1,1) ~= 0
                        nresnexsarterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    else
                        nresnexsarter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    end
                    
                    
                elseif camposimu == 462 %Ex, Ey, Hz e SAR
                    nresnexeyhzsar (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    %feito
                elseif camposimu == 546 %Ex, Ey, Hz e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnexeyhzterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnexeyhzterinfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif MFSB(1,1) && ADSB(1,1) ~= 0
                        nresnexeyhzterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        %feito
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnexeyhzterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0
                        nresnexeyhzterin (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    elseif FSBF(1,1) ~= 0
                        nresnexeyhzterfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif ADSB(1,1) ~= 0
                        nresnexeyhzterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    else
                        nresnexeyhzter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    end
                    
                elseif camposimu == 858 %Ex, Ey, SAR e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnexeysarterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnexeysarterinfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif MFSB(1,1) && ADSB(1,1) ~= 0
                        nresnexeysarterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        %feito
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnexeysarterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0
                        nresnexeysarterin (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    elseif FSBF(1,1) ~= 0
                        nresnexeysarterfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif ADSB(1,1) ~= 0
                        nresnexeysarterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    else
                        nresnexeysarter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    end
                    
                elseif camposimu == 2002 %Ex, Hz, SAR e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnexhzsarterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnexhzsarterinfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif MFSB(1,1) && ADSB(1,1) ~= 0
                        nresnexhzsarterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        %feito
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnexhzsarterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0
                        nresnexhzsarterin (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    elseif FSBF(1,1) ~= 0
                        nresnexhzsarterfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif ADSB(1,1) ~= 0
                        nresnexhzsarterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    else
                        nresneyhzsarter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    end
                    
                elseif camposimu == 6006 %Ex, Ey, Hz, SAR e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnexeyhzsarterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnexeyhzsarterinfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif MFSB(1,1) && ADSB(1,1) ~= 0
                        nresnexeyhzsarterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        %feito
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnexeyhzsarterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0
                        nresnexeyhzsarterin (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    elseif FSBF(1,1) ~= 0
                        nresnexeyhzsarterfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif ADSB(1,1) ~= 0
                        nresnexeyhzsarterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    else
                        nresnexeyhzsarter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    end
                    
                elseif camposimu == 3 %Ey
                    nresney (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, fatey, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    %feito
                elseif camposimu == 21 %Ey e Hz
                    nresneyhz (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, fatey, fathzx, fathzy, Zc, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    %feito
                elseif camposimu == 33 %Ey e SAR
                    nresneysar (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    %feito
                elseif camposimu == 39 %Ey e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresneyterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresneyterinfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif MFSB(1,1) && ADSB(1,1) ~= 0
                        nresneyterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        %feito
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresneyterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0
                        nresneyterin (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    elseif FSBF(1,1) ~= 0
                        nresneyterfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif ADSB(1,1) ~= 0
                        nresneyterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    else
                        nresneyter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    end
                    
                elseif camposimu == 231 %Ey, Hz e SAR
                    nresneyhzsar (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    %feito
                elseif camposimu == 273 %Ey, Hz e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresneyhzterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresneyhzterinfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif MFSB(1,1) && ADSB(1,1) ~= 0
                        nresneyhzterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        %feito
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresneyhzterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0
                        nresneyhzterin (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    elseif FSBF(1,1) ~= 0
                        nresneyhzterfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif ADSB(1,1) ~= 0
                        nresneyhzterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    else
                        nresneyhzter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    end
                    
                elseif camposimu == 429 %Ey, SAR e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresneysarterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresneysarterinfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif MFSB(1,1) && ADSB(1,1) ~= 0
                        nresneysarterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        %feito
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresneysarterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0
                        nresneysarterin (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    elseif FSBF(1,1) ~= 0
                        nresneysarterfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif ADSB(1,1) ~= 0
                        nresneysarterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    else
                        nresneysarter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    end
                    
                elseif camposimu == 3003 %Ey, Hz, SAR e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresneyhzsarterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresneyhzsarterinfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif MFSB(1,1) && ADSB(1,1) ~= 0
                        nresneyhzsarterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        %feito
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresneyhzsarterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0
                        nresneyhzsarterin (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    elseif FSBF(1,1) ~= 0
                        nresneyhzsarterfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif ADSB(1,1) ~= 0
                        nresneyhzsarterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    else
                        nresneyhzsarter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    end
                    
                elseif camposimu == 7   %Hz
                    nresnhz (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk,fathzx, fathzy, Zc, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    %feito
                elseif camposimu == 77 %Hz e SAR
                    nresnhzsar (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    %feito
                elseif camposimu == 91 %Hz e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhzterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnhzterinfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif MFSB(1,1) && ADSB(1,1) ~= 0
                        nresnhzterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        %feito
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhzterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0
                        nresnhzterin (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    elseif FSBF(1,1) ~= 0
                        nresnhzterfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif ADSB(1,1) ~= 0
                        nresnhzterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    else
                        nresnhzter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fathzx, fathzy, Zc, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    end
                    
                elseif camposimu == 1001 %Hz, SAR e T
                    
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhzsarterinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnhzsarterinfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif MFSB(1,1) && ADSB(1,1) ~= 0
                        nresnhzsarterinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        %feito
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnhzsarterfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0
                        nresnhzsarterin (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    elseif FSBF(1,1) ~= 0
                        nresnhzsarterfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif ADSB(1,1) ~= 0
                        nresnhzsarterad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    else
                        nresnhzsarter (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, fathzx, fathzy, Zc, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    end
                    
                elseif camposimu == 11 %SAR
                    nresnsarte (k, nres, cl, resul, malha, Tbs, nsdy, nsdx, ...
                        tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, Tbdk, S, Pin3m, ...
                        Pindk, nnosx, nnosy, toc1, Tx, Ty, entdk)
                    %feito
                elseif camposimu == 143 %SAR e T
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnsarterteinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnsarterteinfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif MFSB(1,1) && ADSB(1,1) ~= 0
                        nresnsarterteinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        %feito
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnsartertefrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0
                        nresnsartertein (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    elseif FSBF(1,1) ~= 0
                        nresnsartertefr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif ADSB(1,1) ~= 0
                        nresnsartertead (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    else
                        nresnsarterte (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, SARval, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    end
                    
                elseif camposimu == 13
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnterteinfrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnterteinfr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif MFSB(1,1) && ADSB(1,1) ~= 0
                        nresnterteinad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter, ...
                            ADSB, ADNO, ADCON)
                        %feito
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresntertefrad (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        %feito
                    elseif MFSB(1,1) ~= 0
                        nresntertein (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, MFSB, MFNO, MFCON, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    elseif FSBF(1,1) ~= 0
                        nresntertefr (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter, ...
                            FSBF, FNOF, FCOF)
                        %feito
                    elseif ADSB(1,1) ~= 0
                        nresntertead (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    else
                        nresnterte (k, nres, cl, resul, malha, Tbs, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, rfemagdk, fatex, fatey, ...
                            Ster, reflint, fonemter, Tbdk, Tbterdk, S, Pin3m, Pindk, nnosx, nnosy, ...
                            toc1, Tx, Ty, Zfatx, Zfaty, entdk, foninter)
                        %feito
                    end
                    
                end
                
                
                
                %% equação de Pennes
            elseif TE == 0 && TM == 0
                if camposimu == 13 %Somente Térmico
                    
                    if MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnter (k, nres, cl, resul, malha, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, Ster, Tbterdk, Pin3m, Pindk, entdk, foninter, ...
                            nnosx, nnosy, toc1, Tx, Ty, reflint, MFSB, MFNO, MFCON, Zfatx, Zfaty, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                        
                    elseif MFSB(1,1) ~= 0 && FSBF(1,1) ~= 0
                        nresnterinfr (k, nres, cl, resul, malha, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, Ster, Tbterdk, Pin3m, Pindk, entdk, foninter, ...
                            nnosx, nnosy, toc1, Tx, Ty, reflint, MFSB, MFNO, MFCON, Zfatx, Zfaty, ...
                            FSBF, FNOF, FCOF)
                        
                    elseif MFSB(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnterinad (k, nres, cl, resul, malha, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, Ster, Tbterdk, Pin3m, Pindk, entdk, foninter, ...
                            nnosx, nnosy, toc1, Tx, Ty, reflint, MFSB, MFNO, MFCON, Zfatx, Zfaty, ...
                            ADSB, ADNO, ADCON)
                    elseif FSBF(1,1) ~= 0 && ADSB(1,1) ~= 0
                        nresnterfrad (k, nres, cl, resul, malha, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, Ster, Tbterdk, Pin3m, Pindk, entdk, foninter, ...
                            nnosx, nnosy, toc1, Tx, Ty, reflint, Zfatx, Zfaty, ...
                            FSBF, FNOF, FCOF, ADSB, ADNO, ADCON)
                    elseif MFSB(1,1) ~= 0
                        nresnterf (k, nres, cl, resul, malha, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, Ster, Tbterdk, Pin3m, Pindk, entdk, foninter, ...
                            nnosx, nnosy, toc1, Tx, Ty, reflint, MFSB, MFNO, MFCON, Zfatx, Zfaty)
                        
                    elseif FSBF(1,1) ~= 0
                        nresnterfro (k, nres, cl, resul, malha, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, Ster, Tbterdk, Pin3m, Pindk, entdk, foninter, ...
                            nnosx, nnosy, toc1, Tx, Ty, reflint, Zfatx, Zfaty, FSBF, FNOF, FCOF)
                        
                    elseif ADSB(1,1) ~= 0
                        nresnterad (k, nres, cl, resul, malha, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, Ster, Tbterdk, Pin3m, Pindk, entdk, foninter, ...
                            nnosx, nnosy, toc1, Tx, Ty, reflint, Zfatx, Zfaty, ...
                            ADSB, ADNO, ADCON)
                        
                    else
                        nresnternff (k, nres, cl, resul, malha, Tbster, nsdy, nsdx, ...
                            tfuncao, funcao, nosfon, Ster, Tbterdk, Pin3m, Pindk, entdk, foninter, ...
                            nnosx, nnosy, toc1, Tx, Ty, reflint, Zfatx, Zfaty)
                        
                    end
                    
                end
            end
        else
            
            disp 'suportado somente para malhas 3x3 ou maior'
            
        end
    end
    %% Encerrando
    clear resul
    disp ' '
    %tempo gasto em hms
    cr = clock;
    
    duracao = seg2dhms(toc);
    save ('todas.mat')
    disp (['Tempo de processamento: ', duracao])
    disp (['Horário do término: ',...
        num2str(cr(4)),'h ',num2str(cr(5)),'m ',...
        num2str(round(cr(6))),'s'])
    disp 'Fim do Processamento'
    
else
    %     dl2 = lambda*0.1;
    f2 = (c*0.1)/dl;
    disp('Não foi atingido a condição de convergência (dl/lambda) < 0.1.')
    disp(['Diminua o dl para pelo menos ', num2str(dl2,'%e')])
    disp(['Ou diminua a frequência para ', num2str(f2,'%e'), ' ou menos'])
    disp (['Mantenha a relação dl*f em ' num2str(c*0.1,'%e'),' ou menos'])
end

